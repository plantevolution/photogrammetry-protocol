<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>6 3D model reconstruction in Agisoft Metashape | Flower photogrammetry and 3D modeling protocol</title>
  <meta name="description" content="This protocol is an evolving protocol used in the Joly lab at the Université de Montréal (Canada)" />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="6 3D model reconstruction in Agisoft Metashape | Flower photogrammetry and 3D modeling protocol" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="http://www.plantevolution.org/photogrammetry-protocol/Figures/cover.jpg" />
  <meta property="og:description" content="This protocol is an evolving protocol used in the Joly lab at the Université de Montréal (Canada)" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="6 3D model reconstruction in Agisoft Metashape | Flower photogrammetry and 3D modeling protocol" />
  
  <meta name="twitter:description" content="This protocol is an evolving protocol used in the Joly lab at the Université de Montréal (Canada)" />
  <meta name="twitter:image" content="http://www.plantevolution.org/photogrammetry-protocol/Figures/cover.jpg" />

<meta name="author" content="Marion Leménager" />
<meta name="author" content="Jérôme Burkiewicz" />
<meta name="author" content="Daniel Schoen" />
<meta name="author" content="Diana Constanza Diaz Cardona" />
<meta name="author" content="Loudmila Jelinscaia Lagou" />
<meta name="author" content="Simon Joly" />


<meta name="date" content="2024-01-24" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="image-post-processing.html"/>
<link rel="next" href="references.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>



<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Flower photogrammetry protocol</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> About</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#citation"><i class="fa fa-check"></i><b>1.1</b> Citation</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#contributing"><i class="fa fa-check"></i><b>1.2</b> Contributing</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#disclaimer"><i class="fa fa-check"></i><b>1.3</b> Disclaimer</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="materials.html"><a href="materials.html"><i class="fa fa-check"></i><b>2</b> Materials</a>
<ul>
<li class="chapter" data-level="2.1" data-path="materials.html"><a href="materials.html#lighting"><i class="fa fa-check"></i><b>2.1</b> Lighting</a></li>
<li class="chapter" data-level="2.2" data-path="materials.html"><a href="materials.html#turntable"><i class="fa fa-check"></i><b>2.2</b> Turntable</a></li>
<li class="chapter" data-level="2.3" data-path="materials.html"><a href="materials.html#camera"><i class="fa fa-check"></i><b>2.3</b> Camera</a></li>
<li class="chapter" data-level="2.4" data-path="materials.html"><a href="materials.html#color-chart"><i class="fa fa-check"></i><b>2.4</b> Color chart</a></li>
<li class="chapter" data-level="2.5" data-path="materials.html"><a href="materials.html#softwares"><i class="fa fa-check"></i><b>2.5</b> Softwares</a></li>
<li class="chapter" data-level="2.6" data-path="materials.html"><a href="materials.html#flowers"><i class="fa fa-check"></i><b>2.6</b> Flowers</a></li>
<li class="chapter" data-level="2.7" data-path="materials.html"><a href="materials.html#summary-of-materials-and-software"><i class="fa fa-check"></i><b>2.7</b> Summary of materials and software</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="settings-and-preparation.html"><a href="settings-and-preparation.html"><i class="fa fa-check"></i><b>3</b> Settings and preparation</a>
<ul>
<li class="chapter" data-level="3.1" data-path="settings-and-preparation.html"><a href="settings-and-preparation.html#camera-and-tripod-settings-and-preparation"><i class="fa fa-check"></i><b>3.1</b> Camera and tripod settings and preparation</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="settings-and-preparation.html"><a href="settings-and-preparation.html#camera-settings"><i class="fa fa-check"></i><b>3.1.1</b> Camera settings</a></li>
<li class="chapter" data-level="3.1.2" data-path="settings-and-preparation.html"><a href="settings-and-preparation.html#optional-custom-camera-white-balance"><i class="fa fa-check"></i><b>3.1.2</b> Optional: custom camera white balance</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="settings-and-preparation.html"><a href="settings-and-preparation.html#turntable-settings-and-preparation"><i class="fa fa-check"></i><b>3.2</b> Turntable settings and preparation</a></li>
<li class="chapter" data-level="3.3" data-path="settings-and-preparation.html"><a href="settings-and-preparation.html#summary-of-settings"><i class="fa fa-check"></i><b>3.3</b> Summary of settings</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="image-capture-step-by-step.html"><a href="image-capture-step-by-step.html"><i class="fa fa-check"></i><b>4</b> Image capture step-by-step</a>
<ul>
<li class="chapter" data-level="4.1" data-path="image-capture-step-by-step.html"><a href="image-capture-step-by-step.html#take-a-picture-of-the-color-chart"><i class="fa fa-check"></i><b>4.1</b> Take a picture of the color chart</a></li>
<li class="chapter" data-level="4.2" data-path="image-capture-step-by-step.html"><a href="image-capture-step-by-step.html#flower-placement-image-capture"><i class="fa fa-check"></i><b>4.2</b> Flower placement &amp; image capture</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="image-post-processing.html"><a href="image-post-processing.html"><i class="fa fa-check"></i><b>5</b> Image post processing</a>
<ul>
<li class="chapter" data-level="5.1" data-path="image-post-processing.html"><a href="image-post-processing.html#file-names-and-storage"><i class="fa fa-check"></i><b>5.1</b> File names and storage</a></li>
<li class="chapter" data-level="5.2" data-path="image-post-processing.html"><a href="image-post-processing.html#image-color-calibration"><i class="fa fa-check"></i><b>5.2</b> Image color calibration</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="image-post-processing.html"><a href="image-post-processing.html#creating-color-profiles"><i class="fa fa-check"></i><b>5.2.1</b> Creating color profiles</a></li>
<li class="chapter" data-level="5.2.2" data-path="image-post-processing.html"><a href="image-post-processing.html#color-and-exposure-calibration-from-profiles"><i class="fa fa-check"></i><b>5.2.2</b> Color and exposure calibration from profiles</a></li>
<li class="chapter" data-level="5.2.3" data-path="image-post-processing.html"><a href="image-post-processing.html#export-calibrated-files"><i class="fa fa-check"></i><b>5.2.3</b> Export calibrated files</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="image-post-processing.html"><a href="image-post-processing.html#image-clustering-one-folder-at-a-time"><i class="fa fa-check"></i><b>5.3</b> Image clustering (one folder at a time)</a></li>
<li class="chapter" data-level="5.4" data-path="image-post-processing.html"><a href="image-post-processing.html#focus-stacking-one-folder-at-a-time"><i class="fa fa-check"></i><b>5.4</b> Focus stacking (one folder at a time)</a></li>
<li class="chapter" data-level="5.5" data-path="image-post-processing.html"><a href="image-post-processing.html#alternatively-cluster-and-focus-stack-photos-from-multiple-folders-at-once"><i class="fa fa-check"></i><b>5.5</b> Alternatively: Cluster and focus stack photos from multiple folders at once</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="d-model-reconstruction-in-agisoft-metashape.html"><a href="d-model-reconstruction-in-agisoft-metashape.html"><i class="fa fa-check"></i><b>6</b> 3D model reconstruction in Agisoft Metashape</a>
<ul>
<li class="chapter" data-level="6.1" data-path="d-model-reconstruction-in-agisoft-metashape.html"><a href="d-model-reconstruction-in-agisoft-metashape.html#download-agisoft-metashape"><i class="fa fa-check"></i><b>6.1</b> Download Agisoft Metashape</a></li>
<li class="chapter" data-level="6.2" data-path="d-model-reconstruction-in-agisoft-metashape.html"><a href="d-model-reconstruction-in-agisoft-metashape.html#initial-tweaks"><i class="fa fa-check"></i><b>6.2</b> Initial tweaks</a></li>
<li class="chapter" data-level="6.3" data-path="d-model-reconstruction-in-agisoft-metashape.html"><a href="d-model-reconstruction-in-agisoft-metashape.html#overview-of-the-model-building-pipeline"><i class="fa fa-check"></i><b>6.3</b> Overview of the model building pipeline</a></li>
<li class="chapter" data-level="6.4" data-path="d-model-reconstruction-in-agisoft-metashape.html"><a href="d-model-reconstruction-in-agisoft-metashape.html#photo-importation"><i class="fa fa-check"></i><b>6.4</b> Photo importation</a></li>
<li class="chapter" data-level="6.5" data-path="d-model-reconstruction-in-agisoft-metashape.html"><a href="d-model-reconstruction-in-agisoft-metashape.html#mask-application"><i class="fa fa-check"></i><b>6.5</b> Mask application</a></li>
<li class="chapter" data-level="6.6" data-path="d-model-reconstruction-in-agisoft-metashape.html"><a href="d-model-reconstruction-in-agisoft-metashape.html#masks-touch-ups"><i class="fa fa-check"></i><b>6.6</b> Masks touch ups</a></li>
<li class="chapter" data-level="6.7" data-path="d-model-reconstruction-in-agisoft-metashape.html"><a href="d-model-reconstruction-in-agisoft-metashape.html#image-alignment"><i class="fa fa-check"></i><b>6.7</b> Image alignment</a></li>
<li class="chapter" data-level="6.8" data-path="d-model-reconstruction-in-agisoft-metashape.html"><a href="d-model-reconstruction-in-agisoft-metashape.html#align-chunks-together"><i class="fa fa-check"></i><b>6.8</b> Align chunks together</a></li>
<li class="chapter" data-level="6.9" data-path="d-model-reconstruction-in-agisoft-metashape.html"><a href="d-model-reconstruction-in-agisoft-metashape.html#merge-chunks"><i class="fa fa-check"></i><b>6.9</b> Merge chunks</a></li>
<li class="chapter" data-level="6.10" data-path="d-model-reconstruction-in-agisoft-metashape.html"><a href="d-model-reconstruction-in-agisoft-metashape.html#build-3d-mesh"><i class="fa fa-check"></i><b>6.10</b> Build 3D mesh</a></li>
<li class="chapter" data-level="6.11" data-path="d-model-reconstruction-in-agisoft-metashape.html"><a href="d-model-reconstruction-in-agisoft-metashape.html#d-mesh-touch-ups"><i class="fa fa-check"></i><b>6.11</b> 3D mesh touch ups</a></li>
<li class="chapter" data-level="6.12" data-path="d-model-reconstruction-in-agisoft-metashape.html"><a href="d-model-reconstruction-in-agisoft-metashape.html#build-texture"><i class="fa fa-check"></i><b>6.12</b> Build texture</a></li>
<li class="chapter" data-level="6.13" data-path="d-model-reconstruction-in-agisoft-metashape.html"><a href="d-model-reconstruction-in-agisoft-metashape.html#scaling"><i class="fa fa-check"></i><b>6.13</b> Scaling</a></li>
<li class="chapter" data-level="6.14" data-path="d-model-reconstruction-in-agisoft-metashape.html"><a href="d-model-reconstruction-in-agisoft-metashape.html#model-orientation"><i class="fa fa-check"></i><b>6.14</b> Model orientation</a></li>
<li class="chapter" data-level="6.15" data-path="d-model-reconstruction-in-agisoft-metashape.html"><a href="d-model-reconstruction-in-agisoft-metashape.html#export-model-and-texture"><i class="fa fa-check"></i><b>6.15</b> Export model and texture</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Flower photogrammetry and 3D modeling protocol</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="d-model-reconstruction-in-agisoft-metashape" class="section level1 hasAnchor" number="6">
<h1><span class="header-section-number">6</span> 3D model reconstruction in Agisoft Metashape<a href="d-model-reconstruction-in-agisoft-metashape.html#d-model-reconstruction-in-agisoft-metashape" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="download-agisoft-metashape" class="section level2 hasAnchor" number="6.1">
<h2><span class="header-section-number">6.1</span> Download Agisoft Metashape<a href="d-model-reconstruction-in-agisoft-metashape.html#download-agisoft-metashape" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Download the Agisoft Metashape professional edition software
<a href="https://www.agisoft.com/downloads/installer/">here</a>. Make sure that
your computer fills the <a href="https://www.agisoft.com/downloads/system-requirements/">minimum system requirements</a>.
The standard edition doesn’t allow the use of the scale option, which we
will need to add a scale to our models.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:agisoft"></span>
<img src="Figures/logo_metashape.jpeg" alt="Agisoft Metashape Logo." width="20%" />
<p class="caption">
Figure 6.1: Agisoft Metashape Logo.
</p>
</div>
</div>
<div id="initial-tweaks" class="section level2 hasAnchor" number="6.2">
<h2><span class="header-section-number">6.2</span> Initial tweaks<a href="d-model-reconstruction-in-agisoft-metashape.html#initial-tweaks" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Agisoft Metashape can use graphic cards at certain steps of the model
construction such as image matching and depth maps calculation. To
enable the use of the graphic hardware (GPU):</p>
<ul>
<li><p>Select Preferences command from the <em>Tools</em> menu (v. &lt;2.0) or <em>MetashapePro</em> menu (v. &gt;2.0).</p></li>
<li><p>In <em>Preferences</em> dialog select <em>GPU</em> tab.</p></li>
<li><p>Select available GPU devices in <em>GPU</em> tab of the <em>Preferences</em> window.</p></li>
</ul>
<p>This step has to be done only once.</p>
<p>This protocol has been elaborated using the version 1.7.1 of Agisoft
Metashape. The latest version of Metashape is now version 2.0.3, but we
still made the following changes. In order to obtain accurate thin
structures, such as petal margin, and avoid holes in your mesh in
Agisoft Metashape versions older than 2.0 (as far as we know) you will need to
activate ONCE the <em>Visibility consistent mesh</em> function in <em>Tools &gt; Preferences &gt; Advanced &gt;Tweaks</em>,
then <em>Add</em> and fill in <em>Parameters</em> with <em>BuildModel/tvl1_mesh</em> and select the
value as <em>False</em> (figure <a href="d-model-reconstruction-in-agisoft-metashape.html#fig:metashapetweaks1">6.2</a>). Additionally, to use the
anterior version of the depth maps generation process, add ONCE the tweak:
<em>BuildDepthMaps/pm_enable</em> and set the value to <em>False</em> (figure <a href="d-model-reconstruction-in-agisoft-metashape.html#fig:metashapetweaks2">6.3</a>).
For Agisoft Metashape 2.0.x (as far as we know) the <em>Preferences</em> are located in the <em>MetashapePro</em> menu.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:metashapetweaks1"></span>
<img src="Figures/Metashape_tweaks_1.png" alt="Tweaks settings (A)." width="80%" />
<p class="caption">
Figure 6.2: Tweaks settings (A).
</p>
</div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:metashapetweaks2"></span>
<img src="Figures/Metashape_tweaks_2.png" alt="Tweaks settings (B)." width="80%" />
<p class="caption">
Figure 6.3: Tweaks settings (B).
</p>
</div>
</div>
<div id="overview-of-the-model-building-pipeline" class="section level2 hasAnchor" number="6.3">
<h2><span class="header-section-number">6.3</span> Overview of the model building pipeline<a href="d-model-reconstruction-in-agisoft-metashape.html#overview-of-the-model-building-pipeline" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To build a model, we need to do the following steps: (1) Import the
calibrated photos, (2) Apply masks to remove the background of the photos, (3)
Align the photos, (4) Calculate depth maps, (5) Build the 3D model (mesh), and
(6) Reconstruct the final texture (model color). There could be different approaches
for each of the steps and options will be given below.</p>
<p>One important thing to consider is whether to align all the photos simultaneously
or proceed by groups of photos (i.e., “chunks”) that correspond to each flower position.
The first approach is quicker and normally results in more accurate models.
However, it does not work all the time. We recommend to try the first approach and if it
fails, to use the alternative approach, which is to divide the pictures in different
"chunks" that will create partial 3D models that will be subsequently merged.</p>
</div>
<div id="photo-importation" class="section level2 hasAnchor" number="6.4">
<h2><span class="header-section-number">6.4</span> Photo importation<a href="d-model-reconstruction-in-agisoft-metashape.html#photo-importation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Go to <em>Workflow</em>, click on <em>Add Photos</em>, and click <em>Open</em>. Once the
photos are imported, they are in a single "chunk".</p>
<p>To try to align all the photos simultaneously (ideal approach), you need
to arrange them in “Image Groups” ot “Camera Groups” (e.g., select the photos, right click, <em>Move Images/Cameras</em> &gt; <em>New Image/Camera Group</em>)*, where each camera group contains
all pictures taken with the same flower orientation and camera angle. Once this is done,
you can add the first photo of each set of photos representing the
label, right click on this photo and select <em>Disable Cameras</em> or <em>Disable Images</em>*. This
allows you to not take it into account while reconstructing the model,
but to keep all the information about the flower in your Metashape
project.</p>
<p>*<strong>Note</strong>: Depending on the version of Agisoft Metashape, some functions use either the word
“camera(s)” (v.&lt;2.0) or “image(s)” (v.&gt;2.0) as far as we know.</p>
</div>
<div id="mask-application" class="section level2 hasAnchor" number="6.5">
<h2><span class="header-section-number">6.5</span> Mask application<a href="d-model-reconstruction-in-agisoft-metashape.html#mask-application" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Masks represent selected areas that are excluded from the feature
detection procedure when applied to key points detection. When several
keypoints are detected as the same point (matched as projections of the
same 3D point on different photos), then it is considered as a tie
point. If masks are applied to tie points, then if a key point is masked
in at least one image, it will not be considered. You can thus use a
single or just a few masks with the second method and apply masks to tie
points. It is however possible to automatically apply masks on each
photo to better constrain key point detection and then apply masks to
keypoints. Using masks helps in removing points from being detected in the
background during the image alignment procedure. You can see examples
<a href="https://agisoft.freshdesk.com/support/solutions/articles/31000158967-aligning-turntable-photos-with-background-suppression-from-single-mask-in-agisoft-metashape">here</a>
on the Agisoft helpdesk portal.</p>
<p><strong>Step-by-step mask application workflow</strong></p>
<ol style="list-style-type: decimal">
<li><p>Duplicate one of your photos, and fill it in black (or the main color of your
background) in any image manipulation software, and rename it to <em>background.jpg</em>
or <em>background.tif</em> depending on the format of your photos.
You can also take a picture of the lightbox without your flower just before
starting to shoot and use this image as background. This sometimes work better.</p></li>
<li><p>Right click on a photo in one of your chunk in your Metashape
project.</p></li>
<li><p>Click on <em>Masks</em>, <em>Import Masks</em> (Figure <a href="d-model-reconstruction-in-agisoft-metashape.html#fig:Metashapemasksrightclick">6.4</a>) and in the box that appears select the method <em>From Background</em> and operation <em>Replacement</em>.</p></li>
<li><p>Enter the same name as the name of the background image you created in step 1.</p></li>
<li><p>Depending on the flower and how contrasting its color is relatively to the background,
the value for <em>Tolerance</em> can vary between approximately 40 and 60 (Figure <a href="d-model-reconstruction-in-agisoft-metashape.html#fig:Metashapemaskstolerance">6.5</a>).
For some pale flowers you may need a lower tolerance value (e.g. 30 or lower).</p></li>
<li><p>Test different values of tolerance on a single photo first and when
you have a value that is satisfactory (i.e., that creates a mask with the
border of the flower well defined), you can select <em>Apply to &gt; Entire workspace</em>.</p></li>
<li><p>Click <em>OK</em>.</p></li>
<li><p>This will automatically produce masks around the flowers for all the
photos in all your chunks. This is why we need a contrasting background color
behind the flower.</p></li>
<li><p>Check for masks that need touch ups (see next section).</p></li>
</ol>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:Metashapemasksrightclick"></span>
<img src="Figures/Metashape_mask_right_click.png" alt="Right click on an image to select a mask to import." width="100%" />
<p class="caption">
Figure 6.4: Right click on an image to select a mask to import.
</p>
</div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:Metashapemaskstolerance"></span>
<img src="Figures/Metashape_masks_tolerance.png" alt="Import mask from a black image *background.jpg*, and select a tolerance value, to test on the selected camera (the image you right-clicked on). If the automatic mask is automatically well adjusted around the flower shape (darker gray around the flower), then apply to entire workspace (all the images)." width="100%" />
<p class="caption">
Figure 6.5: Import mask from a black image <em>background.jpg</em>, and select a tolerance value, to test on the selected camera (the image you right-clicked on). If the automatic mask is automatically well adjusted around the flower shape (darker gray around the flower), then apply to entire workspace (all the images).
</p>
</div>
<p><strong>Alternative masking method using Adobe Photoshop</strong>. It is also possible
to use Adobe Photoshop to apply masks. We did not find particular
improvements compared to the Agisoft Metashape approach.</p>
<ol style="list-style-type: decimal">
<li><p>Go to the file containing the pictures of chunk 1. Copy and paste
this file, naming it accordingly (e.g. <em>Chunk1-Background</em>).</p></li>
<li><p>Go to Adobe Photoshop version 19.1 and up.</p></li>
<li><p>Make a copy of all of the photos you’ll be using and place them in a
new folder labeled <em>Chunk1-masks</em>.</p></li>
<li><p>Then, you will need to create ONCE a Photoshop action, that will be
subsequently reused (see Figures <a href="d-model-reconstruction-in-agisoft-metashape.html#fig:mask1">6.6</a> to <a href="d-model-reconstruction-in-agisoft-metashape.html#fig:mask4">6.9</a> below) :</p></li>
</ol>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:mask1"></span>
<img src="Figures/mask_1.png" alt="Record a new action called *Automatic Mask - 3D reconstruction*." width="100%" />
<p class="caption">
Figure 6.6: Record a new action called <em>Automatic Mask - 3D reconstruction</em>.
</p>
</div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:mask2"></span>
<img src="Figures/mask_2.png" alt="When you reopen your photo, don't forget to remove this extra task in your action." width="100%" />
<p class="caption">
Figure 6.7: When you reopen your photo, don’t forget to remove this extra task in your action.
</p>
</div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:mask3"></span>
<img src="Figures/mask_3.png" alt="The action should include *Select Subject, Fill, Inverse, Fill, Save, Close*, and you can batch process this action to a specific folder of copied photos to create masks." width="100%" />
<p class="caption">
Figure 6.8: The action should include <em>Select Subject, Fill, Inverse, Fill, Save, Close</em>, and you can batch process this action to a specific folder of copied photos to create masks.
</p>
</div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:mask4"></span>
<img src="Figures/mask_4.png" alt="Apply the action to the folder of copied photos called *Chunk1-masks*." width="100%" />
<p class="caption">
Figure 6.9: Apply the action to the folder of copied photos called <em>Chunk1-masks</em>.
</p>
</div>
<ol start="5" style="list-style-type: decimal">
<li><p>Now you should have tranformed all your copied photos into masks,
with the foreground object in white, and the background in black.</p></li>
<li><p>Go to Agisoft Metashape and right click on the first camera (photo)
of chunk 1. Click on <em>Masks &gt; Import Masks</em> and in the box that
appears select method <em>From file</em>, operation <em>Replacement</em>. In
<em>Filename Template</em> use <em>filename.jpg</em>. Select <em>Apply to all
cameras</em> and then click <em>OK</em>.</p></li>
<li><p>Check the masks for touch ups.</p></li>
</ol>
</div>
<div id="masks-touch-ups" class="section level2 hasAnchor" number="6.6">
<h2><span class="header-section-number">6.6</span> Masks touch ups<a href="d-model-reconstruction-in-agisoft-metashape.html#masks-touch-ups" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The automatic application of masks at the previous steps is sometimes
not entirely satisfactory for all photos. To add parts to the mask (i.e., remove
them from the model) such as the foam block and the entomological pin, it is possible
to select them using the selection tools and then add them using the respective
<em>Add Selection</em> button (Figure <a href="d-model-reconstruction-in-agisoft-metashape.html#fig:toolsmasks">6.10</a>). Similarly, you can remove or
invert the selection with the buttons to the right of the <em>Add Selection</em> button.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:toolsmasks"></span>
<img src="Figures/tools_masks.png" alt="Selection tools and add selection to mask tool." width="60%" />
<p class="caption">
Figure 6.10: Selection tools and add selection to mask tool.
</p>
</div>
</div>
<div id="image-alignment" class="section level2 hasAnchor" number="6.7">
<h2><span class="header-section-number">6.7</span> Image alignment<a href="d-model-reconstruction-in-agisoft-metashape.html#image-alignment" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ol style="list-style-type: decimal">
<li><p>Click on the chunk you want to align, which could comprise several
image/camera groups.</p></li>
<li><p>Make sure to disable photos you don’t want (e.g., the label photo, and
blurry photos) and that the masks are clean.</p></li>
<li><p>Go to <em>Workflow</em> &gt; <em>Align Photos</em> and put the accuracy on <em>High</em> or
<em>Very high</em> (do not select the latter if you did focus stacking). To save some time,
you can check <em>Generic preselection</em> in the section <em>Advanced</em>.
Select <em>Apply masks</em> to <em>Key points</em> and click <em>OK</em>. Note that if you
have applied the masks to only some photos, select <em>Apply masks</em> to <em>tie points</em>.</p></li>
<li><p>If you are aligning several chunks of photos, it is possible to run
this job in batch for each chunk in <em>Workflow</em> &gt; <em>Batch Process</em> &gt;
<em>Add</em> and select the <em>Job type</em> as <em>Align Photos</em> to apply to
<em>All Chunks</em> or select specific ones (Figure <a href="d-model-reconstruction-in-agisoft-metashape.html#fig:batchalign">6.11</a>).</p></li>
</ol>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:batchalign"></span>
<img src="Figures/metashape_batch_align.png" alt="Align photos in multiple chunks." width="80%" />
<p class="caption">
Figure 6.11: Align photos in multiple chunks.
</p>
</div>
<ol start="5" style="list-style-type: decimal">
<li><p><strong>Optional: Align using markers.</strong> If the images cannot
align properly, it is possible to place homologous markers on the flower,
defined as remarkable points (e.g., distinguishable pattern such as color dots
on the corolla), or little pen marks at the surface of the
flower when homologous markers lack. These points need to be
clearly identifiable on all chunks. You will need at least 5 markers, ideally
located at different areas of the flower
(e.g., near the pedicel, sepal tips, petals). Do not use points
from the background to align chunks as they are independent from the
flower (the flower changes position relative to the background).</p>
<ol style="list-style-type: decimal">
<li><p>With the <em>Navigation</em> button selected (i.e., the “cursor” tool at the
top), right click on the point you want to add a marker on.</p></li>
<li><p>Click on <em>Place Marker</em> &gt; <em>New Marker</em>.</p></li>
<li><p>In the left panel, rename the marker accordingly. Make sure to use the
same nomenclature on each chunk to be able to merge them
according to their names.</p></li>
</ol></li>
<li><p>To help the software recognize the markers, spread them on photos throughout
the chunk (it is normally sufficient to manually place them on 2-3 photos and the software
normally places them properly on the others, but make sure the markers are all
properly placed).</p></li>
<li><p>If a marker is not visible in some photos, the flag of this marker should be
white or the marker should be blocked on those specific photos. You can do
that by right-clicking on the marker on these photos and select <em>Remove Projection</em>
or <em>Block Marker</em>.</p></li>
<li><p>Repeat these step for each marker.</p></li>
<li><p>Go to <em>Workflow</em> &gt; <em>Align Photos</em> and put the accuracy on <em>High</em> or
<em>Very high</em> (the latter only for project without focus stacking). To save some time,
you can check <em>Generic preselection</em> in the section <em>Advanced</em>.
Select <em>Apply masks</em> to <em>Key points</em> and click <em>OK</em>. Note that if you
have applied the masks to only some photos, select <em>Apply masks</em> to <em>Tie points</em>.</p></li>
<li><p><strong>Optional: Alignment optimization using gradual selection and camera positions.</strong>
If the camera alignment is not satisfactory, it is possible to clean the tie
points obtained and try to re-align the cameras. For instance, in the tie points
generated by the alignment, you can delete outlier and imprecise points
(Figure <a href="d-model-reconstruction-in-agisoft-metashape.html#fig:removepoints1">6.12</a> and <a href="d-model-reconstruction-in-agisoft-metashape.html#fig:removepoints2">6.13</a>):</p>
<ol style="list-style-type: decimal">
<li><p>In the top menu, click on <em>Model</em> and then <em>Gradual Selection</em>.
Select <em>Reconstruction uncertainty</em> on <em>Criterion</em> and play with
the <em>Level</em> value to remove the uncertain points. The higher the
value, the worst is the point placed. Values between 30 and 10
generally give good results. Then <em>OK</em>. Press <em>Delete</em> (or <em>fn + Backspace</em>
in Mac) on your keyboard to delete the selected points in red. You don’t need
much more than 10,000 points for good photo alignments.</p></li>
<li><p>After removing uncertain points, go to <em>View</em> and click on <em>Reference</em> to
make the reference panel visible if it is not already.</p></li>
<li><p>Click on the <em>Optimize Cameras</em> button (star icon) in the reference panel
and in the <em>Optimize Camera Alignment</em> window, check all of the cameras in
the <em>General</em> box and then click <em>OK</em> to optimize the camera posistions.</p></li>
<li><p>In <em>Model &gt; Gradual Selection</em>, ensure that <em>Reprojection
error</em> parameter is below 1. If it is not, check if the
alignment runs well by clicking on the <em>Show Cameras</em> button (camera icon)
on the top (the cameras needs to form a full circle around the flower).
If the alignment fails, try to re-align photos by
following step 3 (don’t forget to check the box <em>Reset Current
Alignment</em>). If the alignment didn’t fail, go to <em>Model &gt;
Gradual Selection &gt; Reproduction error</em>, and set the level to 1
and click OK. Then press <em>Delete</em> (or <em>fn + Backspace</em> in Mac).</p></li>
<li><p>Manually remove remaining outlier points using the selection tools.</p></li>
</ol></li>
<li><p>Repeat these steps for each chunk.</p></li>
</ol>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:removepoints1"></span>
<img src="Figures/metashape_delete_selectedpoints.png" alt="Use the selection tool to remove background points." width="100%" />
<p class="caption">
Figure 6.12: Use the selection tool to remove background points.
</p>
</div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:removepoints2"></span>
<img src="Figures/metashape_gradual_selection.png" alt="Use the gradual selection tool to remove additional mis-calculated points." width="100%" />
<p class="caption">
Figure 6.13: Use the gradual selection tool to remove additional mis-calculated points.
</p>
</div>
<p>*<strong>Note</strong>: If the alignment fails using only one chunk and two or more
camera groups, then it will be necessary to divide your job into several
chunks. Each chunk should then contain photos from one flower position.
Once the chunks are ready, you can proceed with the alignment following
the previous steps.</p>
</div>
<div id="align-chunks-together" class="section level2 hasAnchor" number="6.8">
<h2><span class="header-section-number">6.8</span> Align chunks together<a href="d-model-reconstruction-in-agisoft-metashape.html#align-chunks-together" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><span style="color: red;"><strong>Note: This step is only necessary if your project is divided into several chunks.</strong></span></p>
<p>At this step, it is important to align the different chunks with each
other before they can be combined in a complete model. There are two
ways to do this: using tie points (does not work every time) or using markers.</p>
<ul>
<li>To align using tie points:</li>
</ul>
<ol style="list-style-type: decimal">
<li><p>Select one of the chunks that you would like to align.</p></li>
<li><p>Go to <em>Workflow</em> &gt; <em>Align Chunks</em>, select all the chunks you want to
align together and set the method as <em>Point based</em> (Figure <a href="d-model-reconstruction-in-agisoft-metashape.html#fig:alignchunks">6.14</a>).</p></li>
<li><p>Restrict the key points with masks.</p></li>
<li><p>Click on <em>OK</em>.</p></li>
</ol>
<ul>
<li>To align using markers:</li>
</ul>
<ol style="list-style-type: decimal">
<li><p>Place homologous markers on the flower, defined as remarkable points
(e.g., distinguishable pattern such as color dots on the
corolla), or little pen marks at the surface of the
flower when homologous markers lack. These points need to be
clearly identifiable on all chunks. You will need at least 5 markers, ideally
located at different areas of the flower
(e.g., near the pedicel, sepal tips, petals). Do not use points
from the background to align chunks as they are independent from the
flower (the flower changes position relative to the background).</p>
<ol style="list-style-type: decimal">
<li><p>With the <em>Navigation</em> button selected (i.e., the cursor icon tool),
right click on the point you want to add a marker on.</p></li>
<li><p>Click on <em>Place Marker</em> &gt; <em>New Marker</em>.</p></li>
<li><p>In the left panel, rename the marker accordingly. Make sure to use the
same nomenclature on each chunk to be able to merge them
according to their names.</p></li>
</ol></li>
<li><p>To help the software recognize the markers, spread them on photos throughout
the chunk (it is normally sufficient to manually place them on 2-3 photos and the software
normally places them properly on the others, but make sure the markers are all
properly placed).</p></li>
<li><p>If a marker is not visible in some photos, the flag of this marker should be
white or the marker should be blocked on those specific photos. You can do
that by right-clicking on the marker on these photos and select <em>Remove Projection</em>
or <em>Block Marker</em>.</p></li>
<li><p>Repeat these step for each marker and each chunk.</p></li>
<li><p>Select one chunk. Go to <em>Workflow &gt; Align Chunks</em>, select the
chunks you want to align, set the method as <em>Marker based</em> and then
click <em>OK</em>.</p></li>
</ol>
<p>When the chunks are aligned, a [T] is put at the end of your chunk
name to notify that it is transformed. You can check the alignment using
the icon to show aligned chunks (i.e., the icon of layers on top of each others,
Figure <a href="d-model-reconstruction-in-agisoft-metashape.html#fig:showalignedchunks">6.15</a>). The different chunks should be well
aligned over the whole flower. If the alignment of your chunks is
unsatisfactory, try to place more markers on recognizable features and
spread across the whole flower. Additionally, you can manually align
chunks using the tools to move the models in the space, but this is
highly not recommended.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:alignchunks"></span>
<img src="Figures/metashape_align_chunks.png" alt="Align chunks." width="50%" />
<p class="caption">
Figure 6.14: Align chunks.
</p>
</div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:showalignedchunks"></span>
<img src="Figures/metashape_show_aligned_chunks.png" alt="Show aligned chunks to verify their positions." width="100%" />
<p class="caption">
Figure 6.15: Show aligned chunks to verify their positions.
</p>
</div>
</div>
<div id="merge-chunks" class="section level2 hasAnchor" number="6.9">
<h2><span class="header-section-number">6.9</span> Merge chunks<a href="d-model-reconstruction-in-agisoft-metashape.html#merge-chunks" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><span style="color: red;"><strong>Note: This step is only necessary if your project is divided into several chunks.</strong></span></p>
<p>The next step is to merge chunks together when they are well aligned.
Click on <em>Workflow &gt; Merge chunks</em>, and merge using either the tie
point method or the marker method depending on the option selected
above.</p>
</div>
<div id="build-3d-mesh" class="section level2 hasAnchor" number="6.10">
<h2><span class="header-section-number">6.10</span> Build 3D mesh<a href="d-model-reconstruction-in-agisoft-metashape.html#build-3d-mesh" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ol style="list-style-type: decimal">
<li><p>Select the chunk or the merged chunks for which you want to build a
3D mesh (model).</p></li>
<li><p>Go to <em>Workflow &gt; Build Mesh</em>.</p></li>
<li><p>In the dialog box, make sure that <em>Source Data</em> is on <em>Depth maps</em>,
<em>Quality</em> and <em>Face Count</em> on <em>High</em> (Figure <a href="d-model-reconstruction-in-agisoft-metashape.html#fig:build3Dmesh">6.16</a>).
Note that although it is also possible to generate a mesh from a
dense point cloud (which has to be built separately), the depth maps
provide better results for objects with a high number of minor
details.</p></li>
<li><p>Then go to <em>Advanced</em>, check <em>Calculate vertex colors</em> and click <em>OK</em>.</p></li>
<li><p>Once the mesh is produced, you should remove the pin and extra
floating background parts using the selection tool. This will
highlight the selection in red.</p></li>
<li><p>Verify your selection and press <em>Delete</em> (or <em>fn + Backspace</em>) to remove them.</p></li>
</ol>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:build3Dmesh"></span>
<img src="Figures/metashape_build_mesh.png" alt="Build 3D mesh." width="50%" />
<p class="caption">
Figure 6.16: Build 3D mesh.
</p>
</div>
<blockquote>
<p>Our protocol merges the chunks to build a tie point model of all chunks
before constructing a model for the merge chunk. We found that this is
the best approach, although it is also possible to build models for each
chunk separately and then merge these models to obtain a full model.</p>
</blockquote>
</div>
<div id="d-mesh-touch-ups" class="section level2 hasAnchor" number="6.11">
<h2><span class="header-section-number">6.11</span> 3D mesh touch ups<a href="d-model-reconstruction-in-agisoft-metashape.html#d-mesh-touch-ups" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ol style="list-style-type: decimal">
<li><p>You can smooth the mesh by clicking on <em>Tools</em>, <em>Mesh</em>, <em>Smooth Mesh</em>.
You can also duplicate a 3D model to save one intact
(right click on it and un-check <em>Use as default</em> to keep it as an
archived model). If you smooth a mesh, you can’t undo it.</p></li>
<li><p>You can fill holes in your mesh by clicking on <em>Tools &gt; Mesh &gt; Close Holes</em>.
Note that if your holes are too big, the closing function can create unwanted
structures. Similarly to smoothing, you cannot undo closing holes in the mesh.
<strong>HOWEVER</strong>, this will remove the vertex colors in version 1.7.2, which we will need to
place landmarks when doing the morphometrics.</p></li>
</ol>
</div>
<div id="build-texture" class="section level2 hasAnchor" number="6.12">
<h2><span class="header-section-number">6.12</span> Build texture<a href="d-model-reconstruction-in-agisoft-metashape.html#build-texture" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To build the texture go to <em>Workflow &gt; Build Texture</em>, use the preset
values and click <em>OK</em>.</p>
</div>
<div id="scaling" class="section level2 hasAnchor" number="6.13">
<h2><span class="header-section-number">6.13</span> Scaling<a href="d-model-reconstruction-in-agisoft-metashape.html#scaling" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To scale the model, go to the pictures of your merged chunk and follow
these steps:</p>
<ol style="list-style-type: decimal">
<li><p>On a picture displaying the scale bar, add new markers at each end
of the scale bar and on a couple of additional photos.</p></li>
<li><p>In the left panel, select both markers, right click on them and select
<em>Create Scale Bar</em>.</p></li>
<li><p>If the reference panel is not already visible on the left, go to <em>View</em> and click on
<em>Reference</em>. Go to the reference panel, select the scale under <em>Scale Bars</em> and write
0.01 in the <em>Distance (m)</em> column (except if your scale bar has a different length,
in which case, add the respective value of its length in meters).</p></li>
<li><p>Click on the <em>Update Transform</em> button in the reference panel (icon of two
rotating arrows). This is an important step, because otherwise the scale will
not be incorporated to your model.</p></li>
<li><p>To verify if the scale is taken into account, you can use the
<em>Ruler</em> tool and select two points on your mesh to measure the distance between them.</p></li>
</ol>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:adds-cale"></span>
<img src="Figures/Add_scale.png" alt="Scaling. Top arrow: Markers added at each end of the scale bar (i.e., at the 0 cm and 1 cm points). Middle Arrow: *Update Transform* button. Bottom arrow: Input of scale bar length in meters. Small red box (top): Ruler tool. Large red box (bottom): Reference panel." width="75%" />
<p class="caption">
Figure 6.17: Scaling. Top arrow: Markers added at each end of the scale bar (i.e., at the 0 cm and 1 cm points). Middle Arrow: <em>Update Transform</em> button. Bottom arrow: Input of scale bar length in meters. Small red box (top): Ruler tool. Large red box (bottom): Reference panel.
</p>
</div>
</div>
<div id="model-orientation" class="section level2 hasAnchor" number="6.14">
<h2><span class="header-section-number">6.14</span> Model orientation<a href="d-model-reconstruction-in-agisoft-metashape.html#model-orientation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ol style="list-style-type: decimal">
<li><p>In Metashape, be sure that <em>Show Info</em> and <em>Show Grid</em> in <em>Model &gt; Show/Hide Items</em>
are checked. You should see at the bottom right of the model panel
the 3D axes.</p></li>
<li><p>Make sure that the scale is correct because changing it will affect
the coordinates of the 3D model and you will need to re-orient it. You can
verify the scale using the <em>Ruler</em> tool.</p></li>
<li><p>Use the <em>Navigation</em> tool to orient these 3D axes (x should be at 0° and y should be at 90°; Figure <a href="d-model-reconstruction-in-agisoft-metashape.html#fig:orientation-tools">6.18</a>).</p></li>
<li><p>Once you orient the 3D axes in the wanted direction, you can then
use the tool <em>Move Object</em> to put the flower in the
center of the grid (the cross in the center point of the grid should be hidden
in the central point of the 3D model; Figure <a href="d-model-reconstruction-in-agisoft-metashape.html#fig:orientation-tools">6.18</a> and Figure <a href="d-model-reconstruction-in-agisoft-metashape.html#fig:model-orientation">6.19</a>).</p></li>
<li><p>To orient the model, use the <em>Rotate Object</em>. The model should be facing the right side of the grid (the direction
of the x axis; Figure <a href="d-model-reconstruction-in-agisoft-metashape.html#fig:orientation-tools">6.18</a> and Figure <a href="d-model-reconstruction-in-agisoft-metashape.html#fig:model-orientation">6.19</a>).</p></li>
<li><p>Orient the binding box as well, using the <em>Move Region</em>, <em>Resize Region</em> and <em>Rotate Region</em>
tools. The side with the cross on the box should be on the ventral side of the
flower, and the side with the two dashes should be facing the opening of the flower.
Note that depending on the software you use to open the model, the first view
orientation may change when you open the final object file (Figure <a href="d-model-reconstruction-in-agisoft-metashape.html#fig:binding-box-tools">6.20</a>).</p></li>
</ol>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:orientation-tools"></span>
<img src="Figures/Object_orientation_tools.png" alt="Object (model) orientation tools. Left box: *Navigation* tool. Left box group: Object orientation tools. Arrow: Desired 3D axes orientation." width="100%" />
<p class="caption">
Figure 6.18: Object (model) orientation tools. Left box: <em>Navigation</em> tool. Left box group: Object orientation tools. Arrow: Desired 3D axes orientation.
</p>
</div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:model-orientation"></span>
<img src="Figures/metashape_orientation.png" alt="Desired model orientation on the grid." width="100%" /><img src="Figures/metashape_orientation_2.png" alt="Desired model orientation on the grid." width="100%" />
<p class="caption">
Figure 6.19: Desired model orientation on the grid.
</p>
</div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:binding-box-tools"></span>
<img src="Figures/Binding_box_tools.png" alt="Binding box orientation tools. Box group: Binding box orientation tools. Arrows: The cross and the two dashes on two different sides of the binding box." width="100%" />
<p class="caption">
Figure 6.20: Binding box orientation tools. Box group: Binding box orientation tools. Arrows: The cross and the two dashes on two different sides of the binding box.
</p>
</div>
</div>
<div id="export-model-and-texture" class="section level2 hasAnchor" number="6.15">
<h2><span class="header-section-number">6.15</span> Export model and texture<a href="d-model-reconstruction-in-agisoft-metashape.html#export-model-and-texture" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ol style="list-style-type: decimal">
<li><p>You can export your 3D model by clicking on <em>File</em> &gt; <em>Export</em> &gt;
<em>Export Model</em>.</p></li>
<li><p>Name your model.</p></li>
<li><p>Choose <em>.ply</em> as the extension.</p></li>
<li><p>In the dialog box, tick the <em>Vertex colors</em>. This option will allow
you to get color on the actual 3D model.</p></li>
<li><p>Select <em>Export texture</em> as PNG.</p></li>
<li><p>Make sure to export the texture with transparency, by ticking the
<em>Write alpha channel</em> or <em>Save alpha channel</em> option (depending on the Agisoft
Metashape version). The texture is a separate file with detailed color
information that is wrapped on the model.</p></li>
<li><p>Click on <em>OK</em>.</p></li>
</ol>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="image-post-processing.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/05-model-reconstruction.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
